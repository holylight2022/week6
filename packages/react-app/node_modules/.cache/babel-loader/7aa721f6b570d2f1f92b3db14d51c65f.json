{"ast":null,"code":"import { useRef, useEffect, useCallback } from 'react';\nconst DEBUG = false;\n/**\r\n * @see useOnRepetition for a newer implementation\r\n * helper hook to call a function regularly at time intervals when the block changes.\r\n * @param provider ethers/web3 provider\r\n * @param callbackFn any function\r\n * @param args function parameters\r\n */\n\nexport const useOnBlock = (provider, callbackFn, ...args) => {\n  // save the input function provided\n  const savedCallback = useRef();\n  useEffect(() => {\n    savedCallback.current = callbackFn;\n  }, [callbackFn]); // Turn on the listener if we have a function & a provider\n\n  const listener = useCallback(blockNumber => {\n    if (provider) {\n      if (DEBUG) console.log(blockNumber, callbackFn, args, provider.listeners());\n\n      if (savedCallback.current) {\n        if (args && args.length > 0) {\n          savedCallback.current(...args);\n        } else {\n          savedCallback.current();\n        }\n      }\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, []);\n  useEffect(() => {\n    if (provider) {\n      provider.on('block', listener);\n      return () => {\n        provider.off('block', listener);\n      };\n    } else {\n      return () => {\n        /* cleanup */\n      };\n    } // eslint-disable-next-line react-hooks/exhaustive-deps\n\n  }, [provider]);\n};","map":{"version":3,"sources":["C:/Users/Firebat/challenge-1-decentralized-staking/node_modules/eth-hooks/useOnBlock.js"],"names":["useRef","useEffect","useCallback","DEBUG","useOnBlock","provider","callbackFn","args","savedCallback","current","listener","blockNumber","console","log","listeners","length","on","off"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,SAAjB,EAA4BC,WAA5B,QAA+C,OAA/C;AACA,MAAMC,KAAK,GAAG,KAAd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA,OAAO,MAAMC,UAAU,GAAG,CAACC,QAAD,EAAWC,UAAX,EAAuB,GAAGC,IAA1B,KAAmC;AACzD;AACA,QAAMC,aAAa,GAAGR,MAAM,EAA5B;AACAC,EAAAA,SAAS,CAAC,MAAM;AACZO,IAAAA,aAAa,CAACC,OAAd,GAAwBH,UAAxB;AACH,GAFQ,EAEN,CAACA,UAAD,CAFM,CAAT,CAHyD,CAMzD;;AACA,QAAMI,QAAQ,GAAGR,WAAW,CAAES,WAAD,IAAiB;AAC1C,QAAIN,QAAJ,EAAc;AACV,UAAIF,KAAJ,EACIS,OAAO,CAACC,GAAR,CAAYF,WAAZ,EAAyBL,UAAzB,EAAqCC,IAArC,EAA2CF,QAAQ,CAACS,SAAT,EAA3C;;AACJ,UAAIN,aAAa,CAACC,OAAlB,EAA2B;AACvB,YAAIF,IAAI,IAAIA,IAAI,CAACQ,MAAL,GAAc,CAA1B,EAA6B;AACzBP,UAAAA,aAAa,CAACC,OAAd,CAAsB,GAAGF,IAAzB;AACH,SAFD,MAGK;AACDC,UAAAA,aAAa,CAACC,OAAd;AACH;AACJ;AACJ,KAZyC,CAa1C;;AACH,GAd2B,EAczB,EAdyB,CAA5B;AAeAR,EAAAA,SAAS,CAAC,MAAM;AACZ,QAAII,QAAJ,EAAc;AACVA,MAAAA,QAAQ,CAACW,EAAT,CAAY,OAAZ,EAAqBN,QAArB;AACA,aAAO,MAAM;AACTL,QAAAA,QAAQ,CAACY,GAAT,CAAa,OAAb,EAAsBP,QAAtB;AACH,OAFD;AAGH,KALD,MAMK;AACD,aAAO,MAAM;AACT;AACH,OAFD;AAGH,KAXW,CAYZ;;AACH,GAbQ,EAaN,CAACL,QAAD,CAbM,CAAT;AAcH,CApCM","sourcesContent":["import { useRef, useEffect, useCallback } from 'react';\r\nconst DEBUG = false;\r\n/**\r\n * @see useOnRepetition for a newer implementation\r\n * helper hook to call a function regularly at time intervals when the block changes.\r\n * @param provider ethers/web3 provider\r\n * @param callbackFn any function\r\n * @param args function parameters\r\n */\r\nexport const useOnBlock = (provider, callbackFn, ...args) => {\r\n    // save the input function provided\r\n    const savedCallback = useRef();\r\n    useEffect(() => {\r\n        savedCallback.current = callbackFn;\r\n    }, [callbackFn]);\r\n    // Turn on the listener if we have a function & a provider\r\n    const listener = useCallback((blockNumber) => {\r\n        if (provider) {\r\n            if (DEBUG)\r\n                console.log(blockNumber, callbackFn, args, provider.listeners());\r\n            if (savedCallback.current) {\r\n                if (args && args.length > 0) {\r\n                    savedCallback.current(...args);\r\n                }\r\n                else {\r\n                    savedCallback.current();\r\n                }\r\n            }\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n    useEffect(() => {\r\n        if (provider) {\r\n            provider.on('block', listener);\r\n            return () => {\r\n                provider.off('block', listener);\r\n            };\r\n        }\r\n        else {\r\n            return () => {\r\n                /* cleanup */\r\n            };\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [provider]);\r\n};\r\n"]},"metadata":{},"sourceType":"module"}